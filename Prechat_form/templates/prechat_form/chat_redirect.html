{% extends 'base.html' %}
{% load static %}

{% block title %}Redirecting to Chat{% endblock %}

{% block content %}
<div class="max-w-lg mx-auto text-center">
    <!-- Success Icon -->
    <div class="logo-container inline-flex items-center justify-center w-20 h-20 bg-white rounded-full mb-6 shadow-lg overflow-hidden">
        <img src="{% static 'images/belltpo_logo.jpg' %}" alt="BellTPO Logo" class="w-16 h-16 object-contain">
    </div>

    <!-- Success Message -->
    <h1 class="text-3xl font-bold text-white mb-4">Welcome, {{ user_name }}!</h1>
    <p class="text-indigo-100 mb-8">Your chat session is ready. You'll be redirected automatically.</p>

    <!-- Loading Animation -->
    <div class="glass-effect rounded-2xl p-8 shadow-xl mb-8">
        <div class="flex items-center justify-center mb-4">
            <div class="loading-spinner"></div>
        </div>
        <p class="text-gray-600 mb-4">Connecting to chat...</p>
        
        <!-- Chat Preview -->
        <div class="bg-gray-50 rounded-lg p-4 border-2 border-dashed border-gray-200">
            <div class="flex items-center mb-2">
                <div class="w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center mr-3">
                    <i class="fas fa-robot text-white text-sm"></i>
                </div>
                <span class="text-sm text-gray-600">AI Assistant</span>
            </div>
            <p class="text-sm text-gray-700">Hello {{ user_name }}! I'm ready to help you. How can I assist you today?</p>
        </div>
    </div>

    <!-- Manual Redirect Button -->
    <div class="glass-effect rounded-2xl p-6 shadow-xl">
        <p class="text-gray-600 mb-4">If you're not redirected automatically:</p>
        <a 
            href="{{ chat_url }}" 
            class="btn-primary inline-flex items-center px-6 py-3 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-300"
        >
            <i class="fas fa-comments mr-2"></i>
            Start Chat Now
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Auto-redirect after 3 seconds
    setTimeout(function() {
        window.location.href = "{{ chat_url }}";
    }, 3000);
    
    // Update countdown
    let countdown = 3;
    const countdownElement = document.createElement('span');
    countdownElement.className = 'text-indigo-200 text-sm';
    countdownElement.textContent = `Redirecting in ${countdown} seconds...`;
    
    const container = document.querySelector('.glass-effect p');
    if (container) {
        container.appendChild(document.createElement('br'));
        container.appendChild(countdownElement);
    }
    
    const countdownInterval = setInterval(function() {
        countdown--;
        if (countdown > 0) {
            countdownElement.textContent = `Redirecting in ${countdown} seconds...`;
        } else {
            countdownElement.textContent = 'Redirecting now...';
            clearInterval(countdownInterval);
        }
    }, 1000);
});
</script>
{% endblock %}
